/*
 * Click nbfs://nbhost/SystemFileSystem/Templates/Licenses/license-default.txt to change this license
 * Click nbfs://nbhost/SystemFileSystem/Templates/GUIForms/JPanel.java to edit this template
 */
package ui;

import javax.swing.JOptionPane;
import model.Community;
import model.CommunityList;
import model.Login;
import model.LoginClass;

/**
 *
 * @author amretasrerengarajan
 */
public class AddCommunityAdmin extends javax.swing.JPanel {

    /**
     * Creates new form AddCommunityAdmin
     */
    boolean isCommNameValid = false;
    boolean isCommunityValid = false;

    String commUserName;
    String community;

    LoginClass loginList;
    CommunityList communityList;

    public AddCommunityAdmin(LoginClass loginList, CommunityList communityList) {

        initComponents();

        this.loginList = loginList;
        this.communityList = communityList;

        lblWarningComm.setVisible(false);
        lblWarningUsername.setVisible(false);
        
        txtPasswordField.setText("");
    }

    /**
     * This method is called from within the constructor to initialize the form.
     * WARNING: Do NOT modify this code. The content of this method is always
     * regenerated by the Form Editor.
     */
    @SuppressWarnings("unchecked")
    // <editor-fold defaultstate="collapsed" desc="Generated Code">//GEN-BEGIN:initComponents
    private void initComponents() {

        lblTitle = new javax.swing.JLabel();
        lblUserName = new javax.swing.JLabel();
        lblPassword = new javax.swing.JLabel();
        lblCommunity = new javax.swing.JLabel();
        txtUserName = new javax.swing.JTextField();
        txtCommunity = new javax.swing.JTextField();
        lblWarningUsername = new javax.swing.JLabel();
        lblWarningComm = new javax.swing.JLabel();
        btnAddAdmin = new javax.swing.JButton();
        txtPasswordField = new javax.swing.JPasswordField();

        setBackground(new java.awt.Color(51, 255, 204));

        lblTitle.setFont(new java.awt.Font("Helvetica Neue", 1, 18)); // NOI18N
        lblTitle.setForeground(new java.awt.Color(255, 0, 153));
        lblTitle.setHorizontalAlignment(javax.swing.SwingConstants.CENTER);
        lblTitle.setText("Add New Community User");

        lblUserName.setFont(new java.awt.Font("Helvetica Neue", 1, 13)); // NOI18N
        lblUserName.setForeground(new java.awt.Color(255, 0, 153));
        lblUserName.setHorizontalAlignment(javax.swing.SwingConstants.CENTER);
        lblUserName.setText("User Name:");

        lblPassword.setFont(new java.awt.Font("Helvetica Neue", 1, 13)); // NOI18N
        lblPassword.setForeground(new java.awt.Color(255, 0, 153));
        lblPassword.setHorizontalAlignment(javax.swing.SwingConstants.CENTER);
        lblPassword.setText("Password:");

        lblCommunity.setFont(new java.awt.Font("Helvetica Neue", 1, 13)); // NOI18N
        lblCommunity.setForeground(new java.awt.Color(255, 0, 153));
        lblCommunity.setHorizontalAlignment(javax.swing.SwingConstants.CENTER);
        lblCommunity.setText("Community:");

        txtUserName.addFocusListener(new java.awt.event.FocusAdapter() {
            public void focusLost(java.awt.event.FocusEvent evt) {
                txtUserNameFocusLost(evt);
            }
        });

        txtCommunity.addFocusListener(new java.awt.event.FocusAdapter() {
            public void focusLost(java.awt.event.FocusEvent evt) {
                txtCommunityFocusLost(evt);
            }
        });
        txtCommunity.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                txtCommunityActionPerformed(evt);
            }
        });

        lblWarningUsername.setForeground(new java.awt.Color(255, 0, 0));
        lblWarningUsername.setText("Invalid");

        lblWarningComm.setForeground(new java.awt.Color(255, 0, 0));
        lblWarningComm.setText("Invalid");

        btnAddAdmin.setBackground(new java.awt.Color(204, 255, 204));
        btnAddAdmin.setFont(new java.awt.Font("Helvetica Neue", 1, 13)); // NOI18N
        btnAddAdmin.setForeground(new java.awt.Color(0, 204, 51));
        btnAddAdmin.setText("Add User");
        btnAddAdmin.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btnAddAdminActionPerformed(evt);
            }
        });

        txtPasswordField.setText("jPasswordField1");

        javax.swing.GroupLayout layout = new javax.swing.GroupLayout(this);
        this.setLayout(layout);
        layout.setHorizontalGroup(
            layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(layout.createSequentialGroup()
                .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addGroup(javax.swing.GroupLayout.Alignment.TRAILING, layout.createSequentialGroup()
                        .addContainerGap()
                        .addComponent(lblTitle, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))
                    .addGroup(layout.createSequentialGroup()
                        .addGap(132, 132, 132)
                        .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING, false)
                            .addComponent(lblUserName, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                            .addComponent(lblPassword, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                            .addComponent(lblCommunity, javax.swing.GroupLayout.DEFAULT_SIZE, 106, Short.MAX_VALUE))
                        .addGap(18, 18, 18)
                        .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING, false)
                            .addComponent(txtUserName)
                            .addComponent(txtCommunity)
                            .addComponent(txtPasswordField, javax.swing.GroupLayout.DEFAULT_SIZE, 186, Short.MAX_VALUE))
                        .addGap(18, 18, 18)
                        .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                            .addComponent(lblWarningUsername)
                            .addComponent(lblWarningComm))
                        .addGap(0, 96, Short.MAX_VALUE)))
                .addContainerGap())
            .addGroup(layout.createSequentialGroup()
                .addGap(239, 239, 239)
                .addComponent(btnAddAdmin)
                .addContainerGap(javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))
        );
        layout.setVerticalGroup(
            layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(layout.createSequentialGroup()
                .addGap(22, 22, 22)
                .addComponent(lblTitle)
                .addGap(56, 56, 56)
                .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(lblUserName)
                    .addComponent(txtUserName, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(lblWarningUsername))
                .addGap(18, 18, 18)
                .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addComponent(lblPassword)
                    .addComponent(txtPasswordField, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE))
                .addGap(18, 18, 18)
                .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(lblCommunity)
                    .addComponent(txtCommunity, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(lblWarningComm))
                .addGap(31, 31, 31)
                .addComponent(btnAddAdmin)
                .addContainerGap(340, Short.MAX_VALUE))
        );
    }// </editor-fold>//GEN-END:initComponents
    public String checkCommName(String userName) {
        String regex = "^[a-zA-Z]*$";
        isCommNameValid = userName.matches(regex);
        if (isCommNameValid) {
            return userName;
        } else {
            return "";
        }
    }

    public String checkCommunity(String community) {
        String regex = "^[\\p{L} .'-]+$";
        isCommunityValid = community.matches(regex);
        if (isCommunityValid) {
            return community;
        } else {
            return "";
        }
    }

    private void txtUserNameFocusLost(java.awt.event.FocusEvent evt) {//GEN-FIRST:event_txtUserNameFocusLost
        // TODO add your handling code here:
        String typedName = txtUserName.getText();
        commUserName = checkCommName(typedName);
        if (!isCommNameValid) {
            txtUserName.setText("");
            lblWarningComm.setVisible(isCommNameValid);
        }
    }//GEN-LAST:event_txtUserNameFocusLost

    private void txtCommunityFocusLost(java.awt.event.FocusEvent evt) {//GEN-FIRST:event_txtCommunityFocusLost
        // TODO add your handling code here:
        String typedCommunity = txtCommunity.getText();
        community = checkCommunity(typedCommunity);
        if (!isCommunityValid) {
            txtCommunity.setText("");
            lblWarningComm.setVisible(true);
        }
    }//GEN-LAST:event_txtCommunityFocusLost

    private void btnAddAdminActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btnAddAdminActionPerformed
        // TODO add your handling code here:
        if (txtCommunity.getText().equals("") || txtPasswordField.getText().equals("") || txtUserName.getText().equals("")) {
            JOptionPane.showMessageDialog(this, "All fields are Mandatory");
        } else {
            Community commCredentials = communityList.addCommunityAdmin();
            
            commCredentials.setUserName(commUserName);
            commCredentials.setCommName(commUserName);

            Login commLoginCredentials = loginList.addUsers();
            
            commLoginCredentials.setUserName(commUserName);
            commLoginCredentials.setPassword(txtPasswordField.getText());
            commLoginCredentials.setUserType("Community");

            JOptionPane.showMessageDialog(this, "Community Admin Added Successfully!");

            txtUserName.setText("");
            txtPasswordField.setText("");
            txtCommunity.setText("");
        }
    }//GEN-LAST:event_btnAddAdminActionPerformed

    private void txtCommunityActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_txtCommunityActionPerformed
        // TODO add your handling code here:
    }//GEN-LAST:event_txtCommunityActionPerformed


    // Variables declaration - do not modify//GEN-BEGIN:variables
    private javax.swing.JButton btnAddAdmin;
    private javax.swing.JLabel lblCommunity;
    private javax.swing.JLabel lblPassword;
    private javax.swing.JLabel lblTitle;
    private javax.swing.JLabel lblUserName;
    private javax.swing.JLabel lblWarningComm;
    private javax.swing.JLabel lblWarningUsername;
    private javax.swing.JTextField txtCommunity;
    private javax.swing.JPasswordField txtPasswordField;
    private javax.swing.JTextField txtUserName;
    // End of variables declaration//GEN-END:variables
}
